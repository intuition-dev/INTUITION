extends /layout/layout

block main
   div(width="100%")
      .pad
         h3 Tabulator.js
            span(class="h3_extra") (Tabulator/Firestore)
         table#table1.table-custom

         .buts
            button.btn.btn-success.float-right#create-new Create new row
   
   style.
      .buts button {
         margin: 1rem 0;
      }
      .h3_extra {
         font-size: 12px;
         display: inline-block;
         margin-left: 8px;
      }

      .table-custom {
         width: 100%;
         border-color: #d6d6d6;
      }
      .table-custom .tabulator-header {
         border-bottom: 1px solid #d6d6d6;
      }
      .table-custom .tabulator-header .tabulator-col {
         background-color: #f3f3f3;
      }
      .table-custom .tabulator-row {
         border-bottom: 0;
      }
      .table-custom .tabulator-row.tabulator-selectable:hover {
         background: #f3f3f3;
      }
      .table-custom .tabulator-row .tabulator-cell,
      .table-custom .tabulator-header .tabulator-col {
         border-right: 0;
      }

   script.
      depp.define({
         'TabulatorFormBind': [
            ROOT + 'assets/models/service/TabulatorService.js',
            ROOT + 'assets/models/TabulatorFormViewModel.js',
            'TabulatorFormBind.js',
         ]
      })

      depp.require(['pre','TabulatorFormBind'], setupBinding)

      function setupBinding() {
         console.info('binding', Date.now() - _start)

         var tabulatorFormBind = new TabulatorFormBind()
         tabulatorFormBind.getViewList('table1')

         $('#create-new').on('click', function(ev){
            ev.preventDefault()
            sessionStorage.removeItem('id')
            window.location.replace('/screen/tabulator_form/form')
         })
      }