<!DOCTYPE html>
<html>
  <head>
    <script>var _start = Date.now()</script>
    <title></title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="//cdn.jsdelivr.net/npm/johnnydepp@0.1.0/dist/depp.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/riot@3.13.2/riot.min.js"></script>
    <style>
      .delayShowing { opacity: 0; }
      .blur { -webkit-filter:blur(2px);filter:blur(2px); }
      
    </style>
    <script src="https://cdn.jsdelivr.net/gh/intuition-dev/toolBelt@v1.9.2/toolBelt/toolBelt.min.js"></script>
    <script>toolBeltDefault() </script>
    <script></script>
    <script>
      window.apiPort = location.port
      window.apiProtocol = location.protocol.split(':')[0];
      window.apiHost = location.hostname;
      
      window.appMount = window.location.origin;
      window.siteName = 'MetaBake';
      
    </script>
    <link rel="stylesheet" href="/edit/assets/css/spectreTop.css">
  </head>
  <body>
    <script src="/edit/assets/js/loader.js"></script>
    <div class="login-bg">
      <div class="login-wrapper">
        <div class="login-form-wrap">
          <div class="login-form">
            <form class="js-login-form grid-form" id="login-form" action="#">
              <fieldset>
                <legend> 
                  <div class="site-brand">Site Name</div>Admin CMS 
                </legend>
                <div class="input-wrap">
                  <label>Login</label>
                  <input type="text" name="login" required="required">
                </div>
                <div class="input-wrap">
                  <label>Password</label>
                  <input type="password" name="password" required="required">
                </div>
              </fieldset>
              <div class="d-hide isError" id="error"></div>
              <button class="js-btn-login btn-custom btn-primary btn-center space-21v" id="btn-login">Login</button>
              <p>	Get<a class="upper" href="https://chrome.google.com/webstore/detail/webadmin/oaecohdoihcbaogfkhlfkcdbggnmmbek?hl=en-US">Chrome extension</a></p>
              <p> <span>Not registered?</span><a class="upper" href="#">
                  Visit IntuAPI Admin to create an account</a></p>
              <p><a class="reset-password" href="#" data="reset-password">Forgot password?</a></p>
            </form>
            <form class="d-hide grid-form" id="reset-password" action="#" name="reset-pass-form">
              <fieldset>
                <div class="input-wrap">
                  <label>Enter email</label>
                  <input type="email" name="reset-password-email" required="required">
                </div>
              </fieldset>
              <button class="btn-custom btn-primary btn-center space-21v" name="reset-password-btn" type="submit">Reset Password</button>
            </form>
            <form class="d-hide grid-form" id="reset-password-2" action="#" name="reset-pass-form-2">
              <fieldset>
                <div class="input-wrap">
                  <label>Enter new password</label>
                  <input type="password" name="new-password" required="required">
                </div>
                <div class="input-wrap bl_v-code">
                  <div class="v-code">Verification code was sent to your email</div>
                  <label class="bl_v-code__label">Enter verification code</label>
                  <input class="bl_v-code__input" type="number" name="v-code" required="required">
                </div>
              </fieldset>
              <button class="btn-custom btn-primary btn-center space-21v" name="reset-password-btn-2" type="submit">Reset Password</button>
            </form>
            <div class="bl_pass-changed-notification d-hide js-pass-changed-notification">
              <h1>Password changed</h1>
              <p>You can now sign in with your new password</p>
            </div>
            <div class="bl_pass-changed-notification bl_pass-changed-notification--err d-hide js-pass-changed-notification-err">
              <h1>Password hasn't been changed</h1>
              <p>Something went wrong</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      depp.require(['rw'], function () {
      
      	var bindLogin = new BindLogin();
      
      	/*
      	* editor user login
      	*/
      	$(document).on('submit', '#login-form', function (e) {
      
      		e.preventDefault();
      		let formLogin = $("#login-form input[name='login']").val();
      		let formPassw = $("#login-form input[name='password']").val();
      		bindLogin.checkUser(formLogin, formPassw);
      
      	});
      
      	/*
      	* editor password reset
      	*/
      	$(document).on('click', '[data="reset-password"]', function (e) {
      		e.preventDefault();
      		$('#login-form, #btn-login, [data="reset-password"]').addClass('d-hide');
      		$("[name='reset-pass-form']").removeClass('d-hide');
      	});
      
      	$(document).on('submit', '[name="reset-pass-form"]', function (e) {
      		e.preventDefault();
      		$("[name='reset-pass-form']").addClass('d-hide');
      		$("[name='reset-pass-form-2']").removeClass('d-hide');
      		window.resetEmail = $("[name='reset-password-email']").val();
      		$('.v-code').html('Verification code was sent to ' + resetEmail);
      		bindLogin.sendVcode(resetEmail);
      	});
      
      	let url = new URL(location.href);
      	let urlEmail = url.searchParams.get("email");
      
      	if (urlEmail !== null && urlEmail !== '') {
      
      		$('#login-form, #btn-login, [data="reset-password"]').addClass('d-hide');
      		$("[name='reset-pass-form-2']").removeClass('d-hide');
      		$('.v-code').html('Verification code was sent to ' + urlEmail);
      		bindLogin.sendVcode(urlEmail);
      
      		$(document).on('submit', '[name="reset-pass-form-2"]', function (e) {
      			e.preventDefault();
      			$("[name='reset-pass-form-2']").addClass('d-hide');
      			let password = $("[name='new-password']").val();
      			let vCode = $("[name='v-code']").val();
      			bindLogin.resetPass(urlEmail, vCode, password);
      		});
      
      	} else {
      
      		$(document).on('submit', '[name="reset-pass-form-2"]', function (e) {
      			e.preventDefault();
      			$("[name='reset-pass-form-2']").addClass('d-hide');
      			let password = $("[name='new-password']").val();
      			let vCode = $("[name='v-code']").val();
      			bindLogin.resetPass(resetEmail, vCode, password);
      		});
      
      	}
      
      });
    </script>
  <!-- mB v6.08.9 on 2019-09-02T09:52:01.849Z --></body>
</html>