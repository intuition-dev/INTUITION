<!DOCTYPE html>
<html>
  <head>
    <script>ROOT = '/' //- sets global pug and .js from dat.yaml
      console.log('root','/')
      let _start=Date.now()
    </script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/assets/favicon.png" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/loadjs@3.5.4/dist/loadjs.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/riot@3.11.2/riot.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/signals@1.0.0/dist/signals.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.4.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.4.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.4.2/firebase-firestore.js"></script>
    <style>
      .delayShowing { opacity: 0.01; }
      
    </style>
    <script src="/layoutOff/tags/preRW-tag.min.js"></script>
    <script src="/assets/js/rw.js"></script>
  </head>
  <body>
    <preRW-tag></preRW-tag>
    <script>
      window.preRWtag = riot.mount('preRW-tag')[0]
      
    </script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script src="/assets/js/setup.js"></script>
    <div class="c-offcanvas-content-wrap">
      <!--top-->
      <header class="flex edge">
        <div class="left white">
          <div class="navbar-brand mr-2">
            <h2 id="navBarHead">R/W App </h2>
          </div>
        </div>
        <div class="right white">
          <div class="hide-lg"><a class="btn btn-link" href="/screen/rw">RW</a></div><a class="js-offcanvas-trigger" id="off-cbut" href="#navOpen">
            <div class="white">
              <svg class="bord feather" viewBox="0 0 24 24">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
              </svg>
            </div></a>
        </div>
      </header>
      <div id="router">
        <script>
          window.tableName = 'table_one'
          dtSig = new signals.Signal() // declare data table broadcast
          
        </script>
        <div class="pad"><br>
          <table class="display row-border celled compact" id="list1" width="95%"></table>
          <script>
            window.cols = [
               { "data" : "id", "visible": false, "searchable": false },
               { "data" : "col1",  "title": "Col1" },
               { "data" : "col3" , "title": "Col3" }
            ]
            loadjs.ready(['style'], function () {
               $('#list1').DataTable( {
                  lengthChange: false,
                  info: false,
            
                  select: true,
                  columns : window.cols
               } )//dt
            
               $('#list1 tbody').on('click', 'tr', function () {
                  //*** clicked a row event
                  var row = $('#list1').DataTable().row( this ).data()
            
                  dtSig.dispatch(row)
               })
            })
            
            read(onData1, onErr1)
            
            function onData1(rows) {
               console.log(rows)
               let dt = $('#list1').DataTable()
               dt.clear()
               dt.rows.add(rows)
               dt.draw()
            
            }//onData
            
            function onErr1(err) {
               console.log(err)
            }
          </script>
        </div>
        <div class="pad">
          <div class="grid-form" id="form1" autocomplete="off">
            <fieldset>
              <legend>Form</legend>
              <div data-row-span="2">
                <div data-field-span="1">
                  <label>Field 1</label>
                  <input name="col1" type="text">
                </div>
                <div data-field-span="1">
                  <label>Field 2</label>
                  <input name="col3" type="text">
                </div>
              </div>
            </fieldset>
            <div hidden="" name="id"></div>
          </div>
          <div class="buts">
            <button class="btn" id="clearBut">Clear</button>
            <button class="btn" id="addBut">Add data</button>
            <button class="btn" id="saveBut">Save data</button>
            <button class="btn" id="refBut">Refresh</button>
          </div>
          <style>
            .buts button {
               margin: .5rem;
            }
            
          </style>
          <script>
            function onRow(row) {
               setFields(row, '#form1')
            }
            dtSig.add(onRow) // handle
            
            let form = '#form1'
            loadjs.ready('style', function () {
               $('#clearBut').click(function(){
                 clearFields(form)
               })//click
               $('#addBut').click(function(){
                  let row = getFields(form) 
                  add(row)
               })//click
               $('#saveBut').click(function(){
                  let row = getFields(form) 
                  update( row )
               })//click
               $('#refBut').click(function(){
                  read(onData1, onErr1) // table function
               })//click
            
            }) //on ready
          </script>
        </div>
        <!--link(href= ROOT + 'assets/css/debug.css', rel='stylesheet')-->
        <!-- riot, gridforms, datatables-->
      </div>
    </div>
    <div class="delayShowing" id="navOpen">
      <ul class="nav navBarOpen">
        <h3 class="navBarOpenHea navbar-brand" id="navBarOpenHead">R/W App</h3>
        <li class="nav-item"><a href="/screen/rw">RW</a></li>
      </ul>
    </div>
    <link href="/assets/css/spectre.css" onload="cssLoaded()" rel="stylesheet">
    <link href="/assets/css/nav.css" rel="stylesheet">
    <link href="/assets/css/main.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <script>
      function userSzSc() {
         console.log('resize|scroll')
      }
      
    </script>
  </body>
</html>