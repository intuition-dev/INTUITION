// mB v5.07.08 on 2019-06-07T20:05:29.164Z
!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):e(t.jQuery)}(this,function(t){"use strict"
var e=function(t,i){var n=this
return n.id=e.count++,e.lifo.push(n),t&&n.open(t,i),n}
e.defaults={prefix:"jqi",classes:{box:"",fade:"",prompt:"",form:"",close:"",title:"",message:"",buttons:"",button:"",defaultButton:""},title:"",closeText:"&times;",buttons:{Ok:!0},buttonTimeout:1e3,loaded:function(t){},submit:function(t,e,i,n){},close:function(t,e,i,n){},statechanging:function(t,e,i){},statechanged:function(t,e){},opacity:.6,zIndex:999,overlayspeed:"slow",promptspeed:"fast",show:"fadeIn",hide:"fadeOut",focus:0,defaultButton:0,useiframe:!1,top:"15%",position:{container:null,x:null,y:null,arrow:null,width:null},persistent:!0,timeout:0,states:{},initialState:0,state:{name:null,title:"",html:"",buttons:{Ok:!0},focus:0,defaultButton:0,position:{container:null,x:null,y:null,arrow:null,width:null},submit:function(t,e,i,n){return!0}}},e.setDefaults=function(i){e.defaults=t.extend({},e.defaults,i)},e.setStateDefaults=function(i){e.defaults.state=t.extend({},e.defaults.state,i)},e.count=0,e.lifo=[],e.getLast=function(){var t=e.lifo.length
return t>0&&e.lifo[t-1]},e.removeFromStack=function(t){for(var i=e.lifo.length-1;i>=0;i--)if(e.lifo[i].id===t)return e.lifo.splice(i,1)[0]},e.prototype={id:null,open:function(i,n){var o=this
o.options=t.extend({},e.defaults,n),o.timeout&&clearTimeout(o.timeout),o.timeout=!1
var s,a,r=o.options,u=t(document.body),f=t(window),l='<div class="'+r.prefix+"box "+r.classes.box+'">'
for(s in r.useiframe&&t("object, applet").length>0?l+='<iframe src="javascript:false;" class="'+r.prefix+"fade "+r.classes.fade+'"></iframe>':l+='<div class="'+r.prefix+"fade "+r.classes.fade+'"></div>',l+='<div class="'+r.prefix+" "+r.classes.prompt+'"><form action="#" class="'+r.prefix+"form "+r.classes.form+'"><div class="'+r.prefix+"close "+r.classes.close+'">'+r.closeText+'</div><div class="'+r.prefix+'states"></div></form></div></div>',o.jqib=t(l).appendTo(u),o.jqi=o.jqib.children("."+r.prefix),o.jqif=o.jqib.children("."+r.prefix+"fade"),i.constructor===String&&(i={state0:{title:r.title,html:i,buttons:r.buttons,position:r.position,focus:r.focus,defaultButton:r.defaultButton,submit:r.submit}}),o.options.states={},i)a=t.extend({},e.defaults.state,{name:s},i[s]),o.addState(a.name,a),""===o.currentStateName&&(o.currentStateName=a.name)
o.jqi.on("click","."+r.prefix+"buttons button",function(e){var i=t(this),n=i.parents("."+r.prefix+"state"),s=n.data("jqi-name"),a=o.options.states[s],u=n.children("."+r.prefix+"message"),f=a.buttons[i.text()]||a.buttons[i.html()],l={}
if(o.options.buttonTimeout>0&&(o.disableStateButtons(s),setTimeout(function(){o.enableStateButtons(s)},o.options.buttonTimeout)),void 0===f)for(var p in a.buttons)a.buttons[p].title!==i.text()&&a.buttons[p].title!==i.html()||(f=a.buttons[p].value)
t.each(o.jqi.children("form").serializeArray(),function(t,e){void 0===l[e.name]?l[e.name]=e.value:typeof l[e.name]===Array||"object"==typeof l[e.name]?l[e.name].push(e.value):l[e.name]=[l[e.name],e.value]})
var d=new t.Event("impromptu:submit")
d.stateName=a.name,d.state=n,n.trigger(d,[f,u,l]),d.isDefaultPrevented()||o.close(!0,f,u,l)})
var p=function(){if(r.persistent){var e=r.top.toString().indexOf("%")>=0?f.height()*(parseInt(r.top,10)/100):parseInt(r.top,10),i=parseInt(o.jqi.css("top").replace("px",""),10)-e
t("html,body").animate({scrollTop:i},"fast",function(){var t=0
o.jqib.addClass(r.prefix+"warning")
var e=setInterval(function(){o.jqib.toggleClass(r.prefix+"warning"),t++>1&&(clearInterval(e),o.jqib.removeClass(r.prefix+"warning"))},100)})}else o.close(!0)}
return o.position(),o.style(),o._windowResize=function(t){o.position(t)},f.resize({animate:!1},o._windowResize),o.jqif.click(p),o.jqi.find("."+r.prefix+"close").click(function(){o.close()}),o.jqi.find("."+r.prefix+"form").submit(function(){return!1}),o.jqib.on("keydown",function(e){var i=window.event?event.keyCode:e.keyCode
if(27===i&&p(),13===i){var n=o.getCurrentState().find("."+r.prefix+"defaultbutton")
!1===t(e.target).is("textarea,."+r.prefix+"button")&&n.length>0&&(e.preventDefault(),n.click())}if(9===i){var s=t("input,select,textarea,button",o.getCurrentState()),a=!e.shiftKey&&e.target===s[s.length-1],u=e.shiftKey&&e.target===s[0]
if(a||u)return setTimeout(function(){if(s){var t=s[!0===u?s.length-1:0]
t&&t.focus()}},10),!1}}).on("impromptu:loaded",r.loaded).on("impromptu:close",r.close).on("impromptu:statechanging",r.statechanging).on("impromptu:statechanged",r.statechanged),o.jqif[r.show](r.overlayspeed),o.jqi[r.show](r.promptspeed,function(){o.goToState(isNaN(r.initialState)?r.initialState:o.jqi.find("."+r.prefix+"states ."+r.prefix+"state").eq(r.initialState).data("jqi-name")),o.jqib.trigger("impromptu:loaded")}),r.timeout>0&&(o.timeout=setTimeout(function(){o.close(!0)},r.timeout)),o},close:function(i,n,o,s){var a=this
return e.removeFromStack(a.id),a.timeout&&(clearTimeout(a.timeout),a.timeout=!1),a.jqib&&a.jqib[a.options.hide]("fast",function(){a.jqib.trigger("impromptu:close",[n,o,s]),a.jqib.remove(),t(window).off("resize",a._windowResize),"function"==typeof i&&i()}),a.currentStateName="",a},addState:function(i,n,o){var s,a,r,u,f,l=this,p="",d=null,c="",m="",h=l.options,v=t.isFunction(n.position)?n.position():n.position,g=l.jqi.find("."+h.prefix+"states"),b=[],x=0
if(n=t.extend({},e.defaults.state,{name:i},n),t.isPlainObject(v)&&null!==v.arrow&&(c='<div class="'+h.prefix+"arrow "+h.prefix+"arrow"+v.arrow+'"></div>'),n.title&&""!==n.title&&(m='<div class="lead '+h.prefix+"title "+h.classes.title+'">'+n.title+"</div>"),s=n.html,"function"==typeof n.html&&(s="Error: html function must return text"),p+='<div class="'+h.prefix+'state" data-jqi-name="'+i+'">'+c+m+'<div class="'+h.prefix+"message "+h.classes.message+'">'+s+'</div><div class="'+h.prefix+"buttons"+(t.isEmptyObject(n.buttons)?"hide ":" ")+h.classes.buttons+'">',t.isArray(n.buttons))b=n.buttons
else if(t.isPlainObject(n.buttons))for(r in n.buttons)n.buttons.hasOwnProperty(r)&&b.push({title:r,value:n.buttons[r]})
for(x=0,f=b.length;x<f;x++)u=b[x],a=n.focus===x||isNaN(n.focus)&&n.defaultButton===x?h.prefix+"defaultbutton "+h.classes.defaultButton:"",p+='<button class="'+h.classes.button+" "+h.prefix+"button "+a,void 0!==u.classes&&(p+=" "+(t.isArray(u.classes)?u.classes.join(" "):u.classes)+" "),p+='" name="'+h.prefix+"_"+i+"_button"+u.title.replace(/[^a-z0-9]+/gi,"")+'" value="'+u.value+'">'+u.title+"</button>"
return(d=t(p+="</div></div>").css({display:"none"})).on("impromptu:submit",n.submit),void 0!==o?l.getState(o).after(d):g.append(d),l.options.states[i]=n,d},removeState:function(t,e){var i=this,n=i.getState(t),o=function(){n.remove()}
return 0!==n.length&&("none"!==n.css("display")?void 0!==e&&i.getState(e).length>0?i.goToState(e,!1,o):n.next().length>0?i.nextState(o):n.prev().length>0?i.prevState(o):i.close():n.slideUp("slow",o),!0)},getApi:function(){return this},getBox:function(){return this.jqib},getPrompt:function(){return this.jqi},getState:function(t){return this.jqi.find('[data-jqi-name="'+t+'"]')},getCurrentState:function(){return this.getState(this.getCurrentStateName())},getCurrentStateName:function(){return this.currentStateName},disableStateButtons:function(e,i,n){var o=this
t.isArray(e)&&(i=e,e=null),o.getState(e||o.getCurrentStateName()).find("."+o.options.prefix+"button").each(function(e,o){void 0!==i&&-1===t.inArray(o.value,i)||(o.disabled=!n)})},enableStateButtons:function(t,e){this.disableStateButtons(t,e,!0)},position:function(e){var i=this,n=t.fx.off,o=i.getCurrentState(),s=i.options.states[o.data("jqi-name")],a=s?t.isFunction(s.position)?s.position():s.position:void 0,r=t(window),u=document.body.scrollHeight,f=t(window).height(),l=(t(document).height(),u>f?u:f),p=parseInt(r.scrollTop(),10),d=p+(i.options.top.toString().indexOf("%")>=0?f*(parseInt(i.options.top,10)/100):parseInt(i.options.top,10))
if(void 0!==e&&!1===e.data.animate&&(t.fx.off=!0),i.jqib.css({position:"absolute",height:l,width:"100%",top:0,left:0,right:0,bottom:0}),i.jqif.css({position:"fixed",height:l,width:"100%",top:0,left:0,right:0,bottom:0}),a&&a.container){var c=t(a.container).offset(),m=!1
t.isPlainObject(c)&&void 0!==c.top&&(d=c.top+a.y-(i.options.top.toString().indexOf("%")>=0?f*(parseInt(i.options.top,10)/100):parseInt(i.options.top,10)),i.jqi.css({position:"absolute"}),i.jqi.animate({top:c.top+a.y,left:c.left+a.x,marginLeft:0,width:void 0!==a.width?a.width:null},function(){!m&&c.top+a.y+i.jqi.outerHeight(!0)>p+f&&(t("html,body").animate({scrollTop:d},"slow","swing",function(){}),m=!0)}),(d<p||d>p+f)&&(t("html,body").animate({scrollTop:d},"slow","swing",function(){}),m=!0))}else a&&a.width?(i.jqi.css({position:"absolute",left:"50%"}),i.jqi.animate({top:a.y||d,left:a.x||"50%",marginLeft:a.width/2*-1,width:a.width})):i.jqi.css({position:"absolute",top:d,left:"50%",marginLeft:i.jqi.outerWidth(!1)/2*-1})
void 0!==e&&!1===e.data.animate&&(t.fx.off=n)},style:function(){var t=this
t.jqif.css({zIndex:t.options.zIndex,display:"none",opacity:t.options.opacity}),t.jqi.css({zIndex:t.options.zIndex+1,display:"none"}),t.jqib.css({zIndex:t.options.zIndex})},goToState:function(e,i,n){var o=this,s=(o.jqi,o.options),a=o.getState(e),r=s.states[a.data("jqi-name")],u=new t.Event("impromptu:statechanging"),f=o.options
if(void 0!==r){if("function"==typeof r.html){var l=r.html
a.find("."+f.prefix+"message ").html(l())}"function"==typeof i&&(n=i,i=!1),o.jqib.trigger(u,[o.getCurrentStateName(),e]),!u.isDefaultPrevented()&&a.length>0&&(o.jqi.find("."+f.prefix+"parentstate").removeClass(f.prefix+"parentstate"),i?(o.jqi.find("."+f.prefix+"substate").not(a).slideUp(s.promptspeed).removeClass("."+f.prefix+"substate").find("."+f.prefix+"arrow").hide(),o.jqi.find("."+f.prefix+"state:visible").addClass(f.prefix+"parentstate"),a.addClass(f.prefix+"substate")):o.jqi.find("."+f.prefix+"state").not(a).slideUp(s.promptspeed).find("."+f.prefix+"arrow").hide(),o.currentStateName=r.name,a.slideDown(s.promptspeed,function(){var i=t(this)
o.enableStateButtons(),"string"==typeof r.focus?i.find(r.focus).eq(0).focus():i.find("."+f.prefix+"defaultbutton").focus(),i.find("."+f.prefix+"arrow").show(s.promptspeed),"function"==typeof n&&o.jqib.on("impromptu:statechanged",n),o.jqib.trigger("impromptu:statechanged",[e]),"function"==typeof n&&o.jqib.off("impromptu:statechanged",n)}),i||o.position())}return a},nextState:function(t){var e=this.getCurrentState().next()
return e.length>0&&this.goToState(e.data("jqi-name"),t),e},prevState:function(t){var e=this.getCurrentState().prev()
return e.length>0&&this.goToState(e.data("jqi-name"),t),e}},t.prompt=function(t,i){return new e(t,i).jqi},t.each(e,function(e,i){t.prompt[e]=i}),t.each(e.prototype,function(i,n){t.prompt[i]=function(){var t=e.getLast()
if(t&&"function"==typeof t[i])return t[i].apply(t,arguments)}}),t.fn.prompt=function(e){void 0===e&&(e={}),void 0===e.withDataAndEvents&&(e.withDataAndEvents=!1),t.prompt(t(this).clone(e.withDataAndEvents).html(),e)},window.Impromptu=e})